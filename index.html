<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Civil Files</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Civil Files - تطبيق ويب لمشاركة ملفات الهندسة المدنية">
  <script src="https://unpkg.com/lucide@0.441.0/dist/umd/lucide.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/moment-hijri@2.1.2/moment-hijri.min.js"></script>
  <link rel="stylesheet" href="style.css">

  <link rel="manifest" href="/manifest.json">

</head>
<body>
  <header id="header">
    <div class="header-title">
      <img src="https://i.postimg.cc/Jhr0BFT4/Picsart-25-07-20-16-04-51-889.png" alt="Logo" class="icon">
      Civil Files
    </div>
    <div class="header-icons">
      <button class="icon-btn" onclick="toggleSearch()" title="Search"><i data-lucide="search"></i></button>
      <button class="icon-btn" onclick="toggleDarkMode()" title="Dark Mode"><i data-lucide="moon"></i></button>
      <button class="icon-btn" onclick="toggleSidebar()" title="Menu"><i data-lucide="menu"></i></button>
    </div>
  </header>

  <main id="main-content">
    <h2>مرحبًا بك</h2>
    <img src="https://i.postimg.cc/Y9LHL2xH/Picsart-25-07-22-18-01-32-565.png" alt="Welcome Image" class="main-img">
    <p>ابدأ باختيار القسم من الأسفل</p>
  </main>

  <nav id="nav">
    <div class="nav-item active" onclick="showPage('home')" data-page="home">
      <i data-lucide="home"></i>
      <div>الرئيسية</div>
    </div>
    <div class="nav-item" onclick="showPage('prep')" data-page="prep">
      <i data-lucide="graduation-cap"></i>
      <div>إعدادي</div>
    </div>
    <div class="nav-item" onclick="showPage('civil')" data-page="civil">
      <i data-lucide="hammer"></i>
      <div>مدني</div>
    </div>
    <div class="nav-item" onclick="showPage('favorites')" data-page="favorites">
      <i data-lucide="heart"></i>
      <div>مفضلة</div>
    </div>
  </nav>

  <div class="search-modal" id="searchModal">
    <button class="close-btn" onclick="toggleSearch()">✕</button>
    <input type="text" placeholder="ابحث هنا..." id="searchInput">
    <div class="search-results" id="searchResults"></div>
  </div>

  <div class="sidebar" id="sidebar">
    <i data-lucide="x" class="close-sidebar" onclick="closeSidebar()"></i>
    <div class="sidebar-content">
      <h3>القائمة</h3>
      <ul>
        <li onclick="showPage('home'); closeSidebar()">الرئيسية</li>
        <li onclick="showPage('prep'); closeSidebar()">إعدادي</li>
        <li onclick="showPage('civil'); closeSidebar()">مدني</li>
        <li onclick="showPage('favorites'); closeSidebar()">مفضلة</li>
        <li onclick="showSettings(); closeSidebar()">الإعدادات</li>
        <li onclick="showAbout(); closeSidebar()">حول</li>
      </ul>
    </div>
  </div>

  <div class="about-page" id="aboutPage">
    </div>

  <div class="settings-page" id="settingsPage">
    </div>

  <div id="welcomeModal" class="welcome-modal">
    <div class="modal-content">
      <h2>Civil Engineering Files - Version 1.0</h2>
      <p>Engineer Eslam Wael welcomes you</p>
      <h3>مميزات الموقع</h3>
      <ul>
        <li>محرك بحث سريع للوصول إلى أي مادة</li>
        <li>تصميم يشبه التطبيقات لتجربة أفضل على الهواتف</li>
        <li>إمكانية التبديل بين الوضع العادي والداكن</li>
        <li>تقسيم المواد حسب السنة الدراسية والترم بشكل منظم وواضح</li>
        <li>إمكانية إضافة المواد إلى قائمة المفضلة لسهولة الرجوع إليها</li>
        <li>تنبيه يومي بالصلاة على النبي يظهر عند الدخول</li>
        <li>تم إضافة إشعار يومي بكلمة صباحية تغيّر مودك وتفتح يومك بإيجابية</li>
        <li>رسائل خاصة للمستخدم في المناسبات الإسلامية مثل رمضان وعيد الفطر والأضحى</li>
        <li>يدعم اللغتين: العربية والإنجليزية</li>
        <li>إمكانية تغيير ألوان الموقع والثيم بالكامل من الإعدادات</li>
      </ul>
      <p>هذه مجرد البداية… وستستمر التحسينات والإضافات في الإصدارات القادمة بإذن الله</p>
      <button onclick="closeModal()">OK</button>
    </div>
  </div>
  <script src="main.js"></script>

<script type="module">
  // استيراد مكتبات Firebase بشكل ديناميكي
  const { initializeApp } = await import("https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js");
  const { getMessaging, getToken, onMessage, deleteToken } = await import("https://www.gstatic.com/firebasejs/12.1.0/firebase-messaging.js");

  const firebaseConfig = {
    apiKey: "AIzaSyCXX_kt4-3J_ocNKYAegNTar4Bd9OIgA2k",
    authDomain: "eslam-website.firebaseapp.com",
    projectId: "eslam-website",
    storageBucket: "eslam-website.firebasestorage.app",
    messagingSenderId: "626111073932",
    appId: "1:626111073932:web:f7137bc90e139e822675a9"
  };

  const app = initializeApp(firebaseConfig);
  const messaging = getMessaging(app);

  async function getFCMToken() {
      try {
          const currentToken = await getToken(messaging, {
              vapidKey: 'BK_87m-1h-nUholGBr0inWJM2F-b0_lc9kMjHk3c__9htYJo_tcvXy4HPb_dYF-zHsvbqq8qiyrZ63TnEGF7QeU'
          });
          if (currentToken) {
              console.log('FCM token:', currentToken);
          } else {
              console.log('No registration token available. Request permission to generate one.');
          }
      } catch (err) {
          console.error('An error occurred while retrieving token. ', err);
      }
  }

  getFCMToken();
</script>
<script>
// تسجيل Service Worker للإشعارات
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/firebase-messaging-sw.js')
      .then(registration => {
        console.log('ServiceWorker registered: ', registration);
      })
      .catch(error => {
        console.log('ServiceWorker registration failed: ', error);
      });
  });
}
</script>
</body>
</html>
